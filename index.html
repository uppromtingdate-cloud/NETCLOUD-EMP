<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard Administrativo - CRM y Finanzas</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/widget-system.css" />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  </head>
  <body class="bg-light">
    <!-- Top Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light shadow-sm" style="background:var(--card);">
      <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="#">
          <img src="public/logonetcloud.png" alt="Logo" style="height: 40px; margin-right: 12px; object-fit: contain;" onerror="this.style.display='none'">
          <span>Dashboard Administrativo</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navMain">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a id="nav-inicio" href="#" class="nav-link">Inicio</a></li>
            <li class="nav-item"><a id="nav-clientes" href="#" class="nav-link">Clientes</a></li>
            <li class="nav-item"><a id="nav-documentos" href="#" class="nav-link">Documentos</a></li>
            <li class="nav-item"><a id="nav-finanzas" href="#" class="nav-link">Finanzas</a></li>
            <li class="nav-item"><a id="nav-inventario" href="#" class="nav-link">Inventario</a></li>
            <li class="nav-item"><a id="nav-activos" href="#" class="nav-link">Activos</a></li>
          </ul>

        <div class="d-flex align-items-center" id="auth-area">
            <div id="user-email" class="me-3 small text-muted" style="display:none"></div>
            <button id="btn-logout" class="btn btn-sm btn-outline-danger" style="display:none"><i class="fa fa-sign-out-alt"></i> Cerrar sesión</button>
          </div>
        </div>
      </div>
    </nav>

    <div class="container-fluid mt-4">
      <div class="row g-3">
        <div class="col-12">
          <!-- PANEL INICIO - Resumen de Actividades -->
          <section id="panel-dashboard" class="panel card p-4 mb-3">
            <h4 class="mb-4">Resumen de Actividades</h4>
            <div id="stats-container" class="widget-container">
              <!-- Stat cards renderizadas dinámicamente por JavaScript -->
            </div>
            <div id="widgets-container" class="widget-container">
              <!-- Widgets renderizados dinámicamente por JavaScript -->
            </div>
          </section>

          <!-- PANEL CLIENTES - Kanban -->
          <section id="panel-clientes" class="panel" style="display:none; background: transparent; border: none; padding: 0; margin: 0; height: calc(100vh - 120px);">
            <div style="display: flex; flex-direction: column; height: 100%;">
              <div style="display: flex; justify-content: space-between; align-items: center; padding: 0 15px; margin-bottom: 15px;">
                <h4 class="m-0">Clientes</h4>
                <button id="btn-add-cliente-header" class="btn btn-sm btn-brand"><i class="fa fa-plus"></i> Nuevo Cliente</button>
              </div>
              <div id="kanban-container" class="overflow-x-auto" style="display: flex; gap: 20px; overflow-x: auto; padding: 0 15px 15px 15px; flex: 1; align-items: flex-start;">
                <!-- Columnas generadas dinámicamente por kanban -->
              </div>
            </div>
          </section>

          <section id="panel-documentos" class="panel card p-3 mb-3" style="display:none">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="m-0">Documentos Corporativos</h4>
            </div>
            <p class="small text-muted mb-3">Sube documentos importantes de la empresa: políticas, branding, manuales, etc.</p>
            
            <form id="upload-form" class="row g-2 align-items-center mb-3">
              <div class="col-md-4">
                <select id="upload-tipoDoc" class="form-select form-select-sm">
                  <option value="">Selecciona tipo...</option>
                  <option value="Política">Política</option>
                  <option value="Branding">Branding</option>
                  <option value="Manual">Manual</option>
                  <option value="Procedimiento">Procedimiento</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>
              <div class="col-md-5"><input id="upload-file" type="file" class="form-control form-control-sm" placeholder="Selecciona archivo" /></div>
              <div class="col-md-3 d-grid"><button type="submit" class="btn btn-brand btn-sm">Subir Documento</button></div>
            </form>
            <div id="upload-alert" class="mt-2"></div>
            
            <div id="documentos-list" class="mt-4">
              <h6>Documentos Cargados</h6>
              <div id="docs-container"></div>
            </div>
          </section>

          <section id="panel-finanzas" class="panel" style="display:none; background: transparent; border: none; padding: 0; margin: 0;">
            <div class="mb-4">
              <ul class="nav nav-tabs" id="finanzasTabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="facturas-tab" data-bs-toggle="tab" data-bs-target="#facturas-content" type="button" role="tab">Facturas</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="gastos-tab" data-bs-toggle="tab" data-bs-target="#gastos-content" type="button" role="tab">Gastos Empresariales</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="refrigerios-tab" data-bs-toggle="tab" data-bs-target="#refrigerios-content" type="button" role="tab">Refrigerios</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="pagos-tab" data-bs-toggle="tab" data-bs-target="#pagos-content" type="button" role="tab">Pagos Personal</button>
                </li>
              </ul>

              <div class="tab-content mt-4" id="finanzasTabContent">
                <!-- FACTURAS -->
                <div class="tab-pane fade show active" id="facturas-content" role="tabpanel">
                  <div class="card p-4">
                    <h5 class="mb-3">Facturas de Clientes</h5>
                    <div id="facturas-resumen" class="mb-4"></div>
                    
                    <form id="facturas-form" class="row g-2 mb-3">
                      <div class="col-md-2">
                        <select id="factura-cliente" class="form-select form-select-sm" required>
                          <option value="">Selecciona Cliente</option>
                        </select>
                      </div>
                      <div class="col-md-1"><input id="factura-numero" class="form-control form-control-sm" placeholder="Factura #" required /></div>
                      <div class="col-md-1"><input id="factura-monto-usd" type="number" class="form-control form-control-sm" placeholder="USD" step="0.01" required /></div>
                      <div class="col-md-1"><input id="factura-monto-bs" type="number" class="form-control form-control-sm" placeholder="BS" step="0.01" required /></div>
                      <div class="col-md-1"><input id="factura-fecha" type="date" class="form-control form-control-sm" required /></div>
                      <div class="col-md-1">
                        <select id="factura-estado" class="form-select form-select-sm">
                          <option value="pendiente">Pendiente</option>
                          <option value="pagado">Pagado</option>
                        </select>
                      </div>
                      <div class="col-md-1" style="padding: 0;">
                        <label for="factura-pdf" class="btn btn-outline-secondary btn-sm w-100 mb-0" style="cursor: pointer; padding: 0.375rem 0.75rem;">
                          <i class="fa fa-file-pdf"></i> PDF
                        </label>
                        <input id="factura-pdf" type="file" accept=".pdf" style="display: none;" />
                      </div>
                      <div class="col-md-2"><input id="factura-descripcion" class="form-control form-control-sm" placeholder="Descripción" /></div>
                      <div class="col-md-2 d-grid"><button type="submit" class="btn btn-brand btn-sm">Registrar Factura</button></div>
                    </form>
                    <div id="factura-observaciones-container" class="mb-3">
                      <textarea id="factura-observaciones" class="form-control form-control-sm" placeholder="Observaciones" rows="2"></textarea>
                    </div>
                    <div id="factura-alert" class="mt-2"></div>
                    <div id="facturas-list" class="mt-3"></div>
                  </div>
                </div>

                <!-- GASTOS EMPRESARIALES -->
                <div class="tab-pane fade" id="gastos-content" role="tabpanel">
                  <div class="card p-4">
                    <h5 class="mb-3">Gastos Empresariales (Activos)</h5>
                    <div id="gastos-resumen" class="mb-4"></div>
                    
                    <form id="gastos-empresariales-form" class="row g-2 mb-3">
                      <div class="col-md-2"><input id="gasto-nombre" class="form-control form-control-sm" placeholder="Nombre" required /></div>
                      <div class="col-md-2"><input id="gasto-precio-usd" type="number" class="form-control form-control-sm" placeholder="Precio USD" step="0.01" required /></div>
                      <div class="col-md-2"><input id="gasto-precio-bs" type="number" class="form-control form-control-sm" placeholder="Precio BS" step="0.01" required /></div>
                      <div class="col-md-2"><input id="gasto-fecha" type="date" class="form-control form-control-sm" required /></div>
                      <div class="col-md-2"><input id="gasto-factura" class="form-control form-control-sm" placeholder="Factura (URL)" /></div>
                      <div class="col-md-2 d-grid"><button type="submit" class="btn btn-brand btn-sm">Agregar</button></div>
                    </form>
                    <div id="gasto-observaciones-container" class="mb-3">
                      <textarea id="gasto-observaciones" class="form-control form-control-sm" placeholder="Observaciones" rows="2"></textarea>
                    </div>
                    <div id="gasto-alert" class="mt-2"></div>
                    <div id="gastos-empresariales-list" class="mt-3"></div>
                  </div>
                </div>

                <!-- REFRIGERIOS -->
                <div class="tab-pane fade" id="refrigerios-content" role="tabpanel">
                  <div class="card p-4">
                    <h5 class="mb-3">Historial de Refrigerios</h5>
                    <div id="refrigerios-resumen" class="mb-4"></div>
                    
                    <form id="refrigerios-form" class="row g-2 mb-3">
                      <div class="col-md-2"><input id="refrig-nombre" class="form-control form-control-sm" placeholder="Nombre" required /></div>
                      <div class="col-md-2"><input id="refrig-precio-bs" type="number" class="form-control form-control-sm" placeholder="Precio BS" step="0.01" required /></div>
                      <div class="col-md-2"><input id="refrig-precio-usd" type="number" class="form-control form-control-sm" placeholder="Precio USD" step="0.01" required /></div>
                      <div class="col-md-2"><input id="refrig-fecha" type="date" class="form-control form-control-sm" required /></div>
                      <div class="col-md-2"><input id="refrig-factura" class="form-control form-control-sm" placeholder="Factura (URL)" /></div>
                      <div class="col-md-2 d-grid"><button type="submit" class="btn btn-brand btn-sm">Agregar</button></div>
                    </form>
                    <div id="refrig-observaciones-container" class="mb-3">
                      <textarea id="refrig-observaciones" class="form-control form-control-sm" placeholder="Observaciones" rows="2"></textarea>
                    </div>
                    <div id="refrig-alert" class="mt-2"></div>
                    <div id="refrigerios-list" class="mt-3"></div>
                  </div>
                </div>

                <!-- PAGOS PERSONAL -->
                <div class="tab-pane fade" id="pagos-content" role="tabpanel">
                  <div class="card p-4">
                    <h5 class="mb-3">Pagos Personal (CEOs y Empleados)</h5>
                    <div id="pagos-resumen" class="mb-4"></div>
                    
                    <form id="pagos-personal-form" class="row g-2 mb-3">
                      <div class="col-md-2"><input id="pago-personal-nombre" class="form-control form-control-sm" placeholder="Nombre" required /></div>
                      <div class="col-md-1">
                        <select id="pago-personal-rol" class="form-select form-select-sm" required>
                          <option value="">Rol</option>
                          <option value="CEO">CEO</option>
                          <option value="Empleado">Empleado</option>
                        </select>
                      </div>
                      <div class="col-md-1">
                        <select id="pago-personal-tipo" class="form-select form-select-sm" required>
                          <option value="">Tipo</option>
                          <option value="Salario">Salario</option>
                          <option value="Bono">Bono</option>
                          <option value="Comisión">Comisión</option>
                        </select>
                      </div>
                      <div class="col-md-1"><input id="pago-personal-monto-usd" type="number" class="form-control form-control-sm" placeholder="USD" step="0.01" required /></div>
                      <div class="col-md-1"><input id="pago-personal-monto-bs" type="number" class="form-control form-control-sm" placeholder="BS" step="0.01" required /></div>
                      <div class="col-md-2"><input id="pago-personal-fecha" type="date" class="form-control form-control-sm" required /></div>
                      <div class="col-md-2 d-grid"><button type="submit" class="btn btn-brand btn-sm">Agregar</button></div>
                    </form>
                    <div id="pago-personal-observaciones-container" class="mb-3">
                      <textarea id="pago-personal-observaciones" class="form-control form-control-sm" placeholder="Observaciones" rows="2"></textarea>
                    </div>
                    <div id="pago-personal-alert" class="mt-2"></div>
                    <div id="pagos-personal-list" class="mt-3"></div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section id="panel-inventario" class="panel card p-3 mb-3" style="display:none">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="m-0">Inventario - Productos y Servicios</h4>
              <button id="btn-add-producto" class="btn btn-sm btn-brand"><i class="fa fa-plus"></i> Agregar Producto</button>
            </div>
            <form id="producto-form" class="row g-2 mb-3">
              <div class="col-md-3"><input id="producto-nombre" class="form-control form-control-sm" placeholder="Nombre" required /></div>
              <div class="col-md-2">
                <select id="producto-tipo" class="form-select form-select-sm" required>
                  <option value="">Tipo</option>
                  <option value="producto">Producto</option>
                  <option value="servicio">Servicio</option>
                </select>
              </div>
              <div class="col-md-2"><input id="producto-precio" type="number" class="form-control form-control-sm" placeholder="Precio" step="0.01" required /></div>
              <div class="col-md-2"><input id="producto-costo" type="number" class="form-control form-control-sm" placeholder="Costo" step="0.01" /></div>
              <div class="col-md-1 d-grid"><button type="submit" class="btn btn-brand btn-sm">+</button></div>
            </form>
            <div id="producto-alert" class="mt-2"></div>
            <div id="inventario-list" class="mt-3">
              <table class="table table-sm table-hover">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Tipo</th>
                    <th>Precio</th>
                    <th>Costo</th>
                    <th>Margen</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="inventario-tbody">
                  <!-- Generado dinámicamente -->
                </tbody>
              </table>
            </div>
          </section>

          <section id="panel-activos" class="panel card p-4 mb-3" style="display:none">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="m-0">Activos Fijos - Depreciación Contable</h4>
            </div>
            
            <div id="activos-resumen" class="mb-4"></div>
            
            <form id="activos-form" class="row g-2 mb-3">
              <div class="col-md-2"><input id="activo-nombre" class="form-control form-control-sm" placeholder="Nombre" required /></div>
              <div class="col-md-1"><input id="activo-precio-usd" type="number" class="form-control form-control-sm" placeholder="Precio USD" step="0.01" required /></div>
              <div class="col-md-1"><input id="activo-precio-bs" type="number" class="form-control form-control-sm" placeholder="Precio BS" step="0.01" required /></div>
              <div class="col-md-1"><input id="activo-fecha" type="date" class="form-control form-control-sm" required /></div>
              <div class="col-md-1"><input id="activo-vida-util" type="number" class="form-control form-control-sm" placeholder="Años" min="1" required /></div>
              <div class="col-md-2"><input id="activo-factura" class="form-control form-control-sm" placeholder="Factura (URL)" /></div>
              <div class="col-md-3 d-grid"><button type="submit" class="btn btn-brand btn-sm">Agregar Activo</button></div>
            </form>
            
            <div id="activo-observaciones-container" class="mb-3">
              <textarea id="activo-observaciones" class="form-control form-control-sm" placeholder="Observaciones" rows="2"></textarea>
            </div>
            
            <div id="activo-alert" class="mt-2"></div>
            <div id="activos-list" class="mt-3"></div>
          </section>
        </div>
      </div>
    </div>


    <!-- Modal Agregar Cliente -->
    <div class="modal fade" id="addClientModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Nuevo Cliente</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="add-client-form" class="row g-3">
              <div class="col-12"><input id="cliente-nombre" class="form-control" placeholder="Nombre" required /></div>
              <div class="col-12"><input id="cliente-empresa" class="form-control" placeholder="Empresa" /></div>
              <div class="col-12"><input id="cliente-email" class="form-control" type="email" placeholder="Email" /></div>
              <div class="col-12"><input id="cliente-telefono" class="form-control" placeholder="Teléfono" /></div>
              <div class="col-12">
                <select id="cliente-estado" class="form-select">
                  <option value="Nuevo">Nuevo</option>
                  <option value="Propuesta enviada">Propuesta enviada</option>
                  <option value="Negociación">Negociación</option>
                  <option value="Cerrado - Perdido">Cerrado - Perdido</option>
                  <option value="Cerrado - Ganado">Cerrado - Ganado</option>
                </select>
              </div>
              <div id="add-client-alert" class="col-12"></div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" form="add-client-form" class="btn btn-brand">Agregar Cliente</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Editar Cliente -->
    <div class="modal fade" id="editClienteModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editClienteModalTitle">Cliente</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body" id="editClienteModalBody">
            <!-- Contenido dinámico -->
          </div>
        </div>
      </div>
    </div>

    <!-- Botón Flotante Agregar Cliente -->
    <button id="btn-add-client-float" style="position: fixed; bottom: 30px; right: 30px; width: 48px; height: 48px; border-radius: 50%; padding: 0; display: flex; align-items: center; justify-content: center; font-size: 20px; background: #5734ED; color: white; border: none; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.15); transition: all 0.2s ease;">
      <i class="fa fa-plus"></i>
    </button>

    <!-- Branding esquina inferior derecha -->
    <div style="position: fixed; bottom: 20px; right: 20px; font-size: 24px; font-weight: bold; background: linear-gradient(135deg, #5734ED 0%, #284DC5 100%); color: white; padding: 12px 16px; border-radius: 8px; box-shadow: 0 4px 15px rgba(87, 52, 237, 0.4); letter-spacing: 2px;">
      NETCLOUD
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/main.js"></script>
  </body>
</html>
